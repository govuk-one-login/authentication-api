plugins {
    id 'java'
    id 'application'
    id "jacoco"
}

dependencies {
    implementation configurations.jgit
    implementation configurations.gson
    implementation configurations.logging_runtime

    testImplementation configurations.tests
    testRuntimeOnly configurations.test_runtime
}

test {
    useJUnitPlatform()
    testLogging {
        events "passed", "skipped", "failed"
        exceptionFormat "full"
    }
}

application {
    mainClass = 'DeprecationChecker'
}

task checkDeprecations(type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    mainClass = 'uk.gov.di.deprecationchecker.DeprecationChecker'
    workingDir = project.rootDir
    ignoreExitValue = false
}

jacocoTestReport {
    reports {
        xml.enabled true
    }
    dependsOn "test"
}
